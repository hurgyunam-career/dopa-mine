---
description: Run tools checks before commit message suggestions
alwaysApply: true
---

# Commit Message Recommendation with Tools Check

사용자가 "커밋 메시지 추천"을 요청하면, 메시지 제안 전에 `tools` 검증 스크립트를 먼저 실행한다.

## 실행 규칙

1. 먼저 `git status --short`, `git diff`, `git log --oneline -12`로 변경 범위와 기존 메시지 스타일을 확인한다.
2. 아래 통합 스크립트가 존재하면 실행한다. (내부적으로 4개 검사를 순서대로 실행)
   - `dart run tools/run_commit_checks.dart`
   - 개별 실행이 필요하면: `check_lf_line_endings.dart` → `check_navigation_routes_sync.dart` → `check_project_state_sync.dart` → `check_todo_progress_sync.dart`
3. 스크립트 실행 결과를 답변에 반드시 포함한다.
   - 성공/스킵: 어떤 점검이 통과(또는 SKIP)되었는지 간단히 요약
   - 실패: 실패한 스크립트, 핵심 에러 원인, 사용자가 바로 실행할 조치 1개
4. 점검 결과를 반영해 커밋 단위를 제안하고, 각 단위에 맞는 커밋 메시지(why 중심)를 추천한다.
5. 사용자가 요청하면 첫 커밋 대상만 `git add` 한다.
6. **Issue 로깅 판단**: 현재 채팅이 `docs/issues/README.md` 목적(AI 제안 vs 사용자 결정 분리·출처 투명화)에 맞으면, `docs/issues` 추가 문서 작성·추천을 응답에 포함한다.

## Issue 로깅 판단 기준
- **추천함**: 정책·규격·방식 확정, 스킴/URL/도메인 선택, 문서 구조·규칙 결정 등 **AI 제안과 사용자 판단이 뚜렷이 구분되는** 대화. 여러 문서를 수정·신설한 채팅.
- **추천 안 함**: 단순 버그 수정, 오타 교정, 일회성 실행 명령만 있는 등 결정·제안이 거의 없는 대화.
- 추천 시: `docs/issues` 적합 여부 한 줄 판단, 파일명 예시(`CHAT_YYYY-MM-DD_HH-mm_<topic>.md`), `ISSUES.md` 링크 추가 안내. 사용자가 원하면 해당 채팅용 `CHAT_*.md` 초안(최소 양식·취합용 요약 3줄) 작성 제안.

## 응답 형식

- `검증 상태`: 스크립트별 OK/SKIP/FAIL
- `권장 커밋 단위`: 1개 또는 여러 개
- `추천 커밋 메시지`: prefix(`feat|fix|refactor|test|docs|chore`) 포함, **영문**으로 작성
- `Issue 로깅`: (해당 시) 현재 채팅이 docs/issues 기록에 적합하면 적합 여부·파일명 예시·초안 작성 제안을 포함한다.
